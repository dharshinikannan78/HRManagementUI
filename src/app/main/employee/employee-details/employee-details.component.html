<section *ngIf="!getAdminOnlyRole" class="attendance">
    <div class="container">
        <div class="clock py-4 text-end">
            <button type="button" *ngIf="!check" class="checkIn btn shadow border-0 rounded-3 btn-secondary"
                (click)="attendanceDetails()">
                <div>
                    CheckIn
                </div>
                {{hour}}:{{minute}}:{{second}}:{{AMPM}}
            </button>
            <button type="button" *ngIf="check" class="checkOut btn shadow border-0 rounded-3 btn-secondary"
                (click)="updateattendanceDetails()">
                <div>
                    CheckOut
                </div>
                {{hour}}:{{minute}}:{{second}}:{{AMPM}}
            </button>
        </div>
    </div>
</section>

<section class="pb-3" *ngIf="oneEmployee">
    <div class="container">
        <!-- To Show Single employee details -->
        <div class="row my-5">
            <div class="rounded-4 bg-white shadow col-md-4">
                <div class="row g-3">
                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-2">
                                        <ngx-avatar size="43" [style]="customStyle"
                                            [name]="employeeData.firstName + ' ' + employeeData.lastName"
                                            [src]="baseUrl + employeeData.photoPath">
                                        </ngx-avatar>
                                    </div>
                                    <div class="col-6">
                                        <b
                                            style="color: #323232;">{{employeeData.firstName}}&nbsp;{{employeeData.lastName}}</b>
                                        <br />
                                        <small class="text-muted">{{employeeData.designation}}</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- personal details -->
                    <div class="col-12 mt-4">
                        <div class="card shadow-none mt-3 p-4">
                            <div class="row g-5  mb-2">
                                <div class="col-md-12  d-flex align-items-center">
                                    <div class="iconWrap d-flex align-items-center justify-content-center">
                                        <i class="fa-solid fa-at"></i>
                                    </div>
                                    <div class="ms-3">
                                        <small class="m-0 fw-bold">{{employeeData.emailId}}</small>
                                        <h6 class="m-0 text-muted"><small>Email</small></h6>
                                    </div>
                                </div>
                                <div class="col-md-12  d-flex align-items-center">
                                    <div class="iconWrap d-flex align-items-center justify-content-center">
                                        <i class="fa-solid fa-mobile-screen-button"></i>
                                    </div>
                                    <div class="ms-3">
                                        <p class="m-0 fw-bold">{{employeeData.number}}</p>
                                        <h6 class="m-0 text-muted"><small>Mobile Number</small></h6>
                                    </div>
                                </div>
                                <div class="col-md-12  d-flex align-items-center">
                                    <div class="iconWrap d-flex align-items-center justify-content-center">
                                        <i class="fa-solid fa-cake-candles"></i>
                                    </div>
                                    <div class="ms-3">
                                        <p class="m-0 fw-bold">{{employeeData.dob | date:'MMMM d, y'}}
                                        </p>
                                        <h6 class="m-0 text-muted"><small>Date of Birth</small></h6>
                                    </div>
                                </div>
                                <div class="col-md-12  d-flex align-items-center">
                                    <div class="iconWrap d-flex align-items-center justify-content-center">
                                        <i class="fa-solid fa-file-signature"></i>
                                    </div>
                                    <div class="ms-3">
                                        <p class="m-0 fw-bold">{{employeeData.joiningDate |
                                            date:'MMMMd, y'}}</p>
                                        <h6 class="m-0 text-muted"><small>Date of Joining</small></h6>
                                    </div>
                                </div>
                                <div class="col-md-12  d-flex align-items-center">
                                    <div class="iconWrap d-flex align-items-center justify-content-center">
                                        <i class="fa-solid fa-location-arrow"></i>
                                    </div>
                                    <div class="ms-3">
                                        <p class="m-0 fw-bold">{{employeeData.address}}</p>
                                        <h6 class="m-0 text-muted"><small>Address</small></h6>
                                    </div>
                                </div>
                                <div class="col-md-12  d-flex align-items-center">
                                    <div class="iconWrap d-flex align-items-center justify-content-center">
                                        <i class="fa-solid fa-computer-mouse"></i>
                                    </div>
                                    <div class="ms-3">
                                        <p class="m-0 fw-bold">{{employeeData.workMode}}</p>
                                        <h6 class="m-0 text-muted"><small>Work Mode</small></h6>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- attendance details -->
            <div class="col-md-8">
                <h5 class="p-3 fw-bold">
                    Attendance Details
                </h5>
                <div class="row">
                    <div class="col-12">
                        <div class="table-responsive">
                            <table class="shadow rounded-4 table">
                                <thead class="text-center">
                                    <tr class="thead">
                                        <th scope="col">Name</th>
                                        <th scope="col">Date</th>
                                        <th scope="col">InTime</th>
                                        <th scope="col">OutTime</th>
                                        <th scope="col">WorkDuration</th>
                                        <th scope="col">Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngIf="employeeAttendance?.length == 0" class="text-center">
                                        <td colspan="100%">No Data Found</td>
                                    <tr *ngFor="let data of employeeAttendance" class="text-center">
                                        <td class="col-md-2 py-2 ms-2" style="border: none;">{{data.firstName}}</td>
                                        <td class="col-md-2 py-2 ms-2" style="border: none;">{{data.date |
                                            date:'mediumDate'}}</td>
                                        <td class="col-md-2 py-2 ms-2" style="border: none;">{{data.inTime |
                                            date:'shortTime'}}</td>
                                        <td class="col-md-2 py-2 ms-2" style="border: none;">{{data.outTime == null?
                                            0:data.outTime |
                                            date:'shortTime'}}</td>
                                        <td class="col-md-2 py-2 ms-2" style="border: none;">{{data.workDuration}}</td>
                                        <td class="col-md-2 py-2 ms-2" style="border: none;"><span
                                                class="badge">{{data.status}}</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <!-- task details -->
                    <div class="mt-4 col-12">
                        <h5 class="p-3">
                            Task Details
                        </h5>
                        <div *ngIf="employeeTaskDetail?.length == 0" class="container text-center">
                            <p>
                                No Data Found
                            </p>
                        </div>
                        <div class="card overflow-hidden">
                            <div class="row g-4 p-4 taskRow position-relative">
                                <div class="col-6" *ngFor="let data of employeeTaskDetail">
                                    <div class="card h-100">
                                        <div class="card-body">
                                            <div class="d-flex align-items-center justify-content-between mb-2">
                                                <h5>
                                                    {{data.taskName}}
                                                </h5>
                                            </div>
                                            <small><span class="badge"
                                                    [ngClass]="{'redBadge': data.taskStatus === 'InProgress', 'orangeBadge' : data.taskStatus === 'TODO' }">{{data.taskStatus}}</span></small>
                                            <p class="text-muted mt-3">
                                                <small>{{data.taskDescription}}</small>
                                            </p>
                                            <small><span
                                                    [ngClass]="{'redBadge': data.priority === 'High', 'orangeBadge': data.priority === 'Medium' }"
                                                    class="badge">{{data.priority}}</span></small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<section class="oneEmployee" *ngIf="!oneEmployee">
    <div class="container">
        <div class="accordion" id="accordionExample1">
            <div class="accordion-item mt-3 mb-3" *ngFor="let data of isData; let i = index;">
                <h2 class="accordion-header" id="headingOne1{{i}}">
                    <button class="accordion-button text-dark" [ngClass]=" i!=0 ? 'collapsed' : ''" type="button"
                        data-bs-toggle="collapse" attr.data-bs-target="#collapseOne1{{i}}" aria-expanded="true"
                        attr.aria-controls="collapseOne1{{i}}">
                        {{ data[0].teamName }}
                    </button>
                </h2>
                <div id="collapseOne1{{i}}" [ngClass]=" i==0 ? 'show' : ''" class="accordion-collapse collapse"
                    attr.aria-labelledby="headingOne1{{i}}" data-bs-parent="#accordionExample1">
                    <div class="accordion-body">
                        <div class="container-fluid" id="Employeedata">
                            <div class="row row-cols-1 row-cols-md-3 g-4">
                                <div class="col-md-6 col-lg-4" *ngFor="let data of isData[i]">
                                    <div class="card h-100">
                                        <div class="card-body">
                                            <div class="row align-items-center justify-content-center">
                                                <div class="col-2">
                                                    <ngx-avatar size="43" [style]="customStyle"
                                                        [name]="data.firstName + ' ' + data.lastName"
                                                        [src]="baseUrl + data.photoPath" data-bs-toggle="modal"
                                                        data-bs-target="#editEmpModal"
                                                        (click)="getEmployeeDetails(data.employeeId)">
                                                    </ngx-avatar>
                                                </div>
                                                <div class="col-8">
                                                    <div class="console ps-3">
                                                        <p class="m-0 card-title fw-bold overflow-eplisis">
                                                            {{data.firstName}}&nbsp;&nbsp;{{data.lastName}}
                                                        </p>
                                                        <p class="text-muted m-0 fs-6">{{data.designation}}
                                                        </p>
                                                    </div>
                                                </div>
                                                <div class="col-2 align-self-center">
                                                    <div class="deleteButton btn"
                                                        (click)="deleteEmployeedetails(data.employeeId,data.firstName)">
                                                        <i class="fa-solid fa-trash-can"></i>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal h-100" id="editEmpModal" tabindex="-1" aria-labelledby="editEmpModal" aria-hidden="true">
            <div class="modal-dialog modal-lg h-100">
                <div class="modal-content" [formGroup]="updateEmployeeDetailForm">
                    <div class="modal-header text-center">
                        <h3 class="modal-title text-white">EDIT EMPLOYEE DETAILS</h3>
                        <button type="button" #updateEmployeeModal class="btn-close" data-bs-dismiss="modal"
                            aria-label="Close"></button>
                    </div>
                    <div class="container">
                        <div class="step-wizard mt-3 mb-3">
                            <ul class="step-wizard-list p-0">
                                <li class="step-wizard-item  " [class.current-item]="step==1">
                                    <span class="progress-count">1</span>
                                    <span class="progress-label">Basic Details</span>
                                </li>
                                <li class="step-wizard-item" [class.current-item]="step==2">
                                    <span class="progress-count">2</span>
                                    <span class="progress-label">Contact Details</span>
                                </li>
                                <li class="step-wizard-item" [class.current-item]="step==3">
                                    <span class="progress-count">3</span>
                                    <span class="progress-label">Education Details</span>
                                </li>
                                <li class="step-wizard-item" [class.current-item]="step==4">
                                    <span class="progress-count">4</span>
                                    <span class="progress-label">Work Details</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="container">
                        <form class="add-form" (ngSubmit)="submit(updateEmployeeDetailForm)"
                            [formGroup]="updateEmployeeDetailForm">
                            <div class="widhtTest">
                                <div *ngIf="step==1" id="step1" class="row">
                                    <h4>Basic Details</h4>
                                    <div class="form-group col-md-6">
                                        <label class=" form-label">First Name</label>
                                        <input type="text" class="form-control" formControlName="firstName">
                                        <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['firstName'].valid && 
                                updateEmployeeDetailForm.controls['firstName']?.touched"> <b>First Name</b> is required
                                            *</span>
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label class=" form-label">Last Name</label>
                                        <input type="text" class="form-control" formControlName="lastName">
                                        <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['lastName'].valid && 
                                updateEmployeeDetailForm.controls['lastName']?.touched"> <b>Last Name </b> is required
                                            *</span>
                                    </div>

                                    <div class="form-group col-md-12">
                                        <label class=" form-label">Date Of Birth</label>
                                        <input type="date" class="form-control" formControlName="dob">
                                        <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['dob'].valid && 
                                updateEmployeeDetailForm.controls['dob']?.touched"> <b>Dob</b> is required *</span>
                                    </div>

                                    <div class="form-group col-md-12">
                                        <label class=" form-label mt-3">Gender</label>
                                        <select class="form-select" class="form-control" formControlName="gender">
                                            <option disabled selected value> -- select an option -- </option>
                                            <option value="Female">Female</option>
                                            <option value="Male">Male</option>
                                        </select>
                                        <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['gender'].valid && 
                updateEmployeeDetailForm.controls['gender']?.touched"> <b>Gender</b> is required *</span>
                                    </div>
                                    <!-- <div class="form-group col-12">
                                    <div class="form-check">
                                        <input class="form-check-input" (change)="createLogin = !createLogin" type="checkbox"
                                            id="flexCheckChecked">
                                        <label class="form-check-label" for="flexCheckChecked">
                                            Create Login For this User
                                        </label>
                                    </div>
                                </div>
                                <div *ngIf="createLogin" class="form-group">
                                    <label class=" form-label">Role</label>
                                    <select class="form-select" (change)="loginAccess()" [(ngModel)]="loginAcess"
                                        [ngModelOptions]="{standalone: true}" class="form-control">
                                        <option disabled selected value> -- select an option -- </option>
                                        <option value="Admin">Admin</option>
                                        <option value="Manager">Manager</option>
                                        <option value="TeamLead">TeamLead</option>
                                        <option value="Employee">Employee</option>
                                    </select>
                                    <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['gender'].valid && 
                                            updateEmployeeDetailForm.controls['gender']?.touched"> <b>Role</b> is required *</span>
                                </div> -->
                                </div>
                                <div *ngIf="step==2" id="step2" class="row">
                                    <h4>Contact Details</h4>
                                    <div class="form-group col-md-12">
                                        <label class=" form-label">Email Id</label>
                                        <input type="text" class="form-control" formControlName="emailId">
                                        <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['emailId'].valid && 
                                updateEmployeeDetailForm.controls['emailId']?.touched"> <b>Email Id</b> is required
                                            *</span>
                                    </div>
                                    <div class="form-group col-md-12">
                                        <label class=" form-label">Mobile Number</label>
                                        <input type="text" class="form-control" formControlName="number">
                                        <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['number'].valid && 
                                    updateEmployeeDetailForm.controls['number']?.touched"> <b>Number</b> is required
                                            *</span>
                                    </div>
                                    <div class="form-group col-md-12">
                                        <label class=" form-label">Address</label>
                                        <textarea class="form-control" formControlName="address"></textarea>
                                        <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['address'].valid && 
                                            updateEmployeeDetailForm.controls['address']?.touched"> <b>Address</b> is
                                            required
                                            *</span>
                                    </div>
                                    <div class="form-group col-md-12">
                                        <label class=" form-label">Employee Refernce Number</label>
                                        <input type="text" class="form-control" formControlName="employeeReferenceNo">
                                        <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['employeeReferenceNo'].valid && 
                                    updateEmployeeDetailForm.controls['employeeReferenceNo']?.touched"> <b>Employee
                                                Refernce
                                                Number</b> is
                                            required *</span>
                                    </div>
                                    <!-- <div class="form-group col-12">
                                    <div class="form-check">
                                        <input class="form-check-input" (checked)="createManager= !createManager" type="checkbox"
                                            id="flexCheckCheck">
                                        <label class="form-check-label" for="flexCheckCheck">
                                            Select Reporting Manager
                                        </label>
                                    </div>
                                </div>
                                <div *ngIf="createLogin" class="form-group">
                                    <label class="form-label">Reporting Person</label>
                                    <select formControlName="userId" class="form-select" class="form-control">
                                        <option disabled selected value> -- select an option -- </option>
                
                                        <option *ngFor="let data of reportingPerson" [value]="data.userId">{{data.firstName}}</option>
                                    </select>
                                </div> -->
                                </div>
                                <div *ngIf="step==3" id="step3" class="row">
                                    <h4>Education Details</h4>

                                    <div class="row">
                                        <div class="form-group col-md-6">
                                            <label class=" form-label">Qualification</label>
                                            <input type="text" class="form-control" formControlName="qualification">
                                            <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['qualification'].valid && 
                                    updateEmployeeDetailForm.controls['qualification']?.touched"> <b>Qualification</b>
                                                is
                                                required *</span>
                                        </div>
                                        <div class="form-group col-md-6">
                                            <label class=" form-label">College OR University</label>
                                            <input type="text" class="form-control" formControlName="college">
                                            <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['college'].valid && 
                                        updateEmployeeDetailForm.controls['college']?.touched">
                                                <b>College/University</b> is
                                                required *</span>
                                        </div>

                                        <div class="form-group col-md-6">
                                            <label class=" form-label">Year Of Passing</label>
                                            <input type="date" class="form-control" formControlName="passedOut">
                                            <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['passedOut'].valid && 
                            updateEmployeeDetailForm.controls['passedOut']?.touched"> <b>Year Of Passing</b> is
                                                required *</span>
                                        </div>
                                        <div class="form-group col-md-6">
                                            <label class=" form-label">Team Name</label>
                                            <select class="form-select" class="form-control" formControlName="teamName">
                                                <option disabled selected value> -- select an option -- </option>
                                                <option value="XML">XML</option>
                                                <option value="Software">Software</option>
                                                <option value="E-Pub">E-Pub</option>
                                                <option value="Table">Table</option>
                                            </select>
                                            <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['teamName'].valid && 
                            updateEmployeeDetailForm.controls['teamName']?.touched"> <b>TeamName</b> is required
                                                *</span>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="form-group col-md-12">
                                            <label class=" form-label">Skills</label>
                                            <input type="text" class="form-control" formControlName="skills">
                                            <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['skills'].valid && 
                        updateEmployeeDetailForm.controls['skills']?.touched"> <b>Skills</b> is required *</span>
                                        </div>
                                    </div>
                                </div>
                                <div *ngIf="step==4" class="row" id="step4">
                                    <h4>Work Details</h4>
                                    <div class="form-group col-md-6">
                                        <label class=" form-label">Designation</label>
                                        <select class="form-select" class="form-control" formControlName="designation">
                                            <option disabled selected value> -- select an option -- </option>
                                            <option value="Front End">Front End</option>
                                            <option value="Back End">Back End</option>
                                            <option value="Full Stack">Full Stack</option>
                                        </select>
                                        <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['designation'].valid && 
                                        updateEmployeeDetailForm.controls['designation']?.touched"> <b>Designation</b>
                                            is
                                            required *</span>
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label class=" form-label">Joining Date</label>
                                        <input type="date" class="form-control" formControlName="joiningDate">
                                        <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['joiningDate'].valid && 
                                        updateEmployeeDetailForm.controls['joiningDate']?.touched"> <b>Joining Date</b>
                                            is
                                            required *</span>
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label class=" form-label">Work Mode</label>
                                        <select class="form-select" class="form-control" formControlName="workMode">
                                            <option disabled selected value> -- select an option -- </option>
                                            <option value="Frontt End">Part Time</option>
                                            <option value="Back End">Full Time</option>
                                        </select>
                                        <span class="text-danger" *ngIf="!updateEmployeeDetailForm.controls['workMode'].valid && 
                                            updateEmployeeDetailForm.controls['workMode']?.touched"> <b>WorkMode</b> is
                                            required
                                            *</span>
                                    </div>
                                    <div class="form-group col-md-12">
                                        <label class=" form-label mt-3">Download Attachment</label>
                                        <app-attachment [attachmentId]="attachment.attachmentIds"></app-attachment>
                                    </div>
                                </div>
                                <div class="modal-footer mt-5">
                                    <button type="button text-center me-1" class="submitButton" *ngIf="step!=1"
                                        (click)="prev()">
                                        <i class="fa-solid fa-chevron-left"></i>
                                        Prev
                                    </button>
                                    <button type="button" class="submitButton" *ngIf="step!=4 " (click)=" next()">Next
                                        <i class="fa-solid fa-chevron-right"></i></button>
                                    <button type="submit" class="submitButton" [disabled]="!thisFormValid()"
                                        *ngIf="step==4">Finish <i class="fa-solid fa-circle-check"></i></button>
                                </div>
                            </div>

                        </form>
                    </div>

                </div>
            </div>
        </div>

    </div>
</section>